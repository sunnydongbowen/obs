---
{"dg-publish":true,"dg-permalink":"用户和用户组管理","permalink":"/用户和用户组管理/","noteIcon":"","created":"2021-01-09","updated":""}
---


> 这个操作很重要，我在咸鱼上接单发现很多都是这种题目，创建用户，用户组。限制权限以及空间。如果感兴趣可以接个小练习试试。用户管理虽然用的不多，但是在企业里或者学校中很多人用一台机器的时候就会用到了 [[F.计算机学习笔记/Linux云计算/Linux基础/关于root权限的问题\|关于root权限的问题]]  文件权限方面的用的还是挺多的。

## root用户
---
一般情况，尽量别用root用户来操作，如果是正式环境，轻易给别人用root权限，风险很大。[[F.计算机学习笔记/Linux云计算/Linux基础/关于root权限的问题\|关于root权限的问题]]
普通用户要想执行一些高权限命令，可以加sudo ，否则会报权限不足的错误！例如

```bash
sudo groupadd dev
```

## 组管理
---
```bash
groupadd dev
groupdel dev
cat /etc/group
# 添加组
[root@os14 bowen]# cat -n /etc/group | grep dev
    65  stapdev:x:158:
    76  dev:x:1001:
# 删除组
[root@os14 bowen]# groupdel dev
[root@os14 bowen]# cat -n /etc/group | grep dev
    65  stapdev:x:158:
# 修文件所属组
chgrp -R dev python123/
# 修改文件所属用户
chown cloud  python123/
drwxr-xr-x. 2 cloud dev     6 Dec 29 18:40 python123
```

## 用户管理
---
- 添加用户
    - m 自动建立用户家目录
    - g 指定用户所在的组，如果不指定，默认自动创建和用户重名的组

```bash
useradd -m -g 
useradd -m -g dev bowen001 # 注意后面才是用户名，前面是组名
```

- 修改密码
    - <span style="background:rgba(240, 107, 5, 0.2)">新建目录后一定要给用户加密码</span>
    - 加密码用root用户
```bash
passwd
[root@os14 home]# passwd bowen001
Changing password for user bowen001.
New password:
BAD PASSWORD: The password is shorter than 8 characters
Retype new password:
passwd: all authentication tokens updated successfully.
```

权限
```bash
# 新建的用户是无法在根目录下创建文件的，只可以在自己的家目录下玩
[bowen001@os14 home]$ touch 1.txt
touch: cannot touch '1.txt': Permission denied
# 自己目录，并且别的对这个目录只有只读权限，是不能随意在里面写数据的！这就确保了各个用户间的独立
[bowen001@os14 ~]$ touch 001.txt
[bowen001@os14 ~]$ ll
total 0
-rw-r--r--. 1 bowen001 dev 0 Dec 29 19:17 001.txt
```

- 删除用户
    - <span style="background:rgba(240, 107, 5, 0.2)"> -r 同时删除家目录</span>
```bash
userdel -r bowen001   # 注意退出这个用户登录，不然会报被占用！
```

- id
```bash
id cloud
uid=1000(cloud) gid=1000(cloud) groups=1000(cloud),10(wheel)

id root
uid=0(root) gid=0(root) groups=0(root)

cat /etc/passwd** | grep cloud
cloud:x:1000:1000:cloud:/home/cloud:/bin/bash

[root@os14 bowen]# cat /etc/group | grep dev
stapdev:x:158:
dev:x:1001:
```

x表示有密码且是加密的，后面是用户和组代号
```bash
[root@os14 bowen]# cat /etc/passwd | grep cloud
cloud:x:1000:1000:cloud:/home/cloud:/bin/bash
```

用户名:密码：用户id：组id：用户全名或本地账号：家目录：登录时使用的shell
![Pasted image 20230714200849.png](/img/user/Pasted%20image%2020230714200849.png)

用户和组管理还是很重要的，一方面尤其是在大公司，对权限要求高的，会用到，另外这次中了挖矿病毒按照网上也没解决，结果人家改了文件名字，非root权限不能修改文件，这样就有效去除了挖矿病毒。现实中遇到的问题远远要复杂的多

```bash
chown root config.json
chgrp root config.json
-rw-r--r--. 1 root root 8485 Dec 30 12:38 config.json
```

- usermod
```bash
# 修改用户的主组
usermod -g 组  用户

# 修改用户的附加组
usermod -G 组 用户名

# 想让普通的用户具有sudo权限，使用sudo命令。useradd加的用户是没有这个命令权限的
usermod -G sudo 用户名
usermod -d 目录名 用户名 # 修改用户登录的默认目录
# 修改用户登录shell，会有颜色区分的！在ubuntu默认add的是dash，centos不知道，了解即可
usermod -s /bin/bash 用户名
```

- su 命令,切换用户，注意和sudo区别
```bash
su    # 切换用户
exit  # 退出
```

`su -`  切换到家目录
su     不接任何用户名，就可以是root用户。

## 修改文件权限
---
```bash
chown root config.json
chgrp root config.json
chgrp -R 组名 文件名
chmod +x   test.py
chmod +r var
chmod -x var
```

常用的
```bash
chmod -R 755 文件名|目录名
# **对应的用户，组，其他的权限，比chmod +x 这一类的精确一些，chmod修改的是用户的权限，当然一般也够用**
r  w  x  -
4  2  1  0
```

##  超级用户

![Pasted image 20230714093307.png](/img/user/Z.image/linux%E5%9F%BA%E7%A1%80/Pasted%20image%2020230714093307.png)